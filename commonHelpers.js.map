{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n  \nconst API_KEY = \"41636185-b642aedee9ddf38a3f46d8b56\"\naxios.defaults.baseURL = \"https://pixabay.com\";\n\nexport const getPosts = (query, page = 1, per_page = 15) => {\n      try {\n  \n return axios(`/api/`, {\n    params: {\n      key: API_KEY,\n      q: query,\n      page,\n      per_page,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true'\n    },\n  });\n  }\n  catch {\n    iziToast.error({\n            title: \"Error\",\n            message: `Something went wrong. ${error.message}`\n        })\n  }\n};\n\n \n\n\n","export const renderImg = (hits) => {\n  return hits.reduce((html, { largeImageURL, webformatURL, tags, likes, views, comments, downloads }) => {\n    return (\n      html +\n      `<li class=\"gallery-item\">\n        <a href=${largeImageURL}> \n          <img class=\"gallery-img\" src=${webformatURL} alt=\"${tags}\"/>\n        </a>\n        <div class=\"gallery-text-box\">\n          <p>Likes: <span class=\"text-value\">${likes}</span></p>\n          <p>Views: <span class=\"text-value\">${views}</span></p>\n          <p>Comments: <span class=\"text-value\">${comments}</span></p>\n          <p>Downloads: <span class=\"text-value\">${downloads}</span></p>\n        </div>\n      </li>`\n    );\n  }, '');\n  \n}\n\n\n\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { getPosts } from './js/pixabay-api.js';\nimport { renderImg } from './js/render-functions.js';\n\nconst formEl = document.querySelector(\".form\");\nconst galleryEl = document.querySelector(\".gallery\");\nconst searchInput = document.getElementById('search-input');\nconst loader = document.querySelector(\".loader\");\nconst pageButton = document.querySelector(\".page-btn\");\n\nlet page = 1;\nlet query = null;\nlet totalHits = 0;\nlet lightbox;\n\nloader.classList.add(\"hidden\");\npageButton.classList.add(\"hidden\");\n\nconst handleSubmit = async (event) => {\n  event.preventDefault();\n\n  query = searchInput.value.trim();\n\n  if (!query) {\n    return iziToast.info({\n      message: 'Please enter text',\n      position: 'topCenter'\n    });\n  }\n\n  loader.classList.remove(\"hidden\");\n  pageButton.classList.add(\"hidden\");\n  galleryEl.innerHTML = '';\n\n  try {\n    const response = await getPosts(query, page);\n    const { hits, totalHits: newTotalHits } = response.data;\n    totalHits = newTotalHits;  \n\n    if (hits.length > 0) {\n      galleryEl.innerHTML = renderImg(hits);\n\n      if (!lightbox) {\n        lightbox = new SimpleLightbox('.gallery a', {\n          nav: true,\n          captionsData: 'alt',\n          captionDelay: 250,\n          close: true,\n          enableKeyboard: true,\n          docClose: true\n        });\n      } \n        lightbox.refresh();\n      \n\n      if (totalHits > 15) {\n        pageButton.classList.remove(\"hidden\");\n      }\n    } else {\n      return iziToast.error({\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topCenter'\n      });\n    }\n  } catch (error) {\n    console.error('Error:', error);\n    iziToast.error({\n      message: 'An error occurred. Try again later.',\n      position: 'topCenter'\n    });\n  } finally {\n    loader.classList.add(\"hidden\");\n  }\n};\n\nformEl.addEventListener('submit', handleSubmit);\n\nconst pageMore = async () => {\n  page += 1;\n  loader.classList.remove(\"hidden\");\n\n  try {\n    const response = await getPosts(query, page);\n    const { hits } = response.data;\n\n    if (hits.length > 0) {\n      const markup = renderImg(hits);\n      galleryEl.insertAdjacentHTML(\"beforeend\", markup);\n      lightbox.refresh();\n\n      const item = document.querySelector(\".gallery-item\");\n      const height = item.getBoundingClientRect().height;\n      window.scrollBy({\n        left: 0,\n        top: height * 2,\n        behavior: \"smooth\"\n      });\n\n      if (totalHits <= page * 15) {\n        pageButton.classList.add(\"hidden\");\n        iziToast.info({\n          title: 'No more info',\n          message: \"We're sorry, but you've reached the end of search results.\"\n        });\n      }\n    } else {\n      iziToast.info({\n        title: 'No more results',\n        message: \"No additional images found.\"\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      title: \"Error\",\n      message: `Something went wrong. ${error.message}`\n    });\n  } finally {\n    loader.classList.add('hidden');\n  }\n};\n\npageButton.addEventListener(\"click\", pageMore);"],"names":["API_KEY","axios","getPosts","query","page","per_page","iziToast","renderImg","hits","html","largeImageURL","webformatURL","tags","likes","views","comments","downloads","formEl","galleryEl","searchInput","loader","pageButton","totalHits","lightbox","handleSubmit","event","response","newTotalHits","SimpleLightbox","error","pageMore","markup","height"],"mappings":"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"}